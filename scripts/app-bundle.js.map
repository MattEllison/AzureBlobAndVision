{"version":3,"sources":["src/app.ts","src/environment.ts","src/main.ts","src/resources/index.ts","src/Models/Picture.ts","src/Models/VisionResponse.ts","src/resources/elements/form-upload.ts","src/resources/elements/uploaded-picture.ts","src/resources/service/blobStorage.ts","src/resources/service/visionapi.ts"],"names":[],"mappings":"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","file":"app-bundle.js","sourcesContent":["import { autoinject } from 'aurelia-dependency-injection';\r\nimport { BloblStorage } from './resources/service/blobStorage';\r\nimport { Picture } from './Models/Picture';\r\nimport { VisionResponse } from './Models/VisionResponse';\r\nimport { VisionApi } from './resources/service/visionapi';\r\nimport { HttpClient } from \"aurelia-http-client\";\r\n\r\n\r\n\r\n@autoinject\r\nexport class App {\r\n  files;\r\n  pictures: Array<Picture> = new Array<Picture>();\r\n\r\n  constructor(private blobStorage: BloblStorage, private visionAPI: VisionApi) {\r\n\r\n  }\r\n\r\n  attached() {\r\n    this.blobStorage\r\n      .GetPictures()\r\n      .then(pictures => {\r\n        console.log(\"Got pics\", pictures)\r\n        pictures.forEach(picture => {\r\n          this.blobStorage.GetBlobCaption(picture.filename).then(caption => {\r\n            console.log(\"Caption\",caption);\r\n            picture.caption = caption;\r\n            this.pictures.push(picture);\r\n          });\r\n        });\r\n\r\n\r\n      });\r\n  }\r\n\r\n}\r\n","export default {\r\n  debug: true,\r\n  testing: true\r\n};\r\n","import {Aurelia} from 'aurelia-framework'\r\nimport environment from './environment';\r\n\r\nexport function configure(aurelia: Aurelia) {\r\n  aurelia.use\r\n    .standardConfiguration()\r\n    .feature('resources');\r\n\r\n  if (environment.debug) {\r\n    aurelia.use.developmentLogging();\r\n  }\r\n\r\n  if (environment.testing) {\r\n    aurelia.use.plugin('aurelia-testing');\r\n  }\r\n\r\n  aurelia.start().then(() => aurelia.setRoot());\r\n}\r\n","import {FrameworkConfiguration} from 'aurelia-framework';\r\n\r\nexport function configure(config: FrameworkConfiguration) {\r\n  //config.globalResources([]);\r\n}\r\n","  \r\n\r\nexport class Picture {\r\n    filename: any;\r\n    caption: string;\r\n    name;\r\n    url;\r\n    isNotCat(){\r\n        return !this.caption.toLocaleLowerCase().includes(\"cat\");\r\n    }\r\n}","\r\n\r\nexport class VisionResponse {\r\n    constructor(response) {\r\n        this.caption = response.description.captions[0].text;\r\n        this.name = this.caption = response.description.captions[0].text;\r\n    }\r\n    caption: string;\r\n    name;\r\n}","import { Picture } from './../../Models/Picture';\r\nimport { VisionApi } from './../service/visionapi';\r\nimport { autoinject } from 'aurelia-dependency-injection';\r\nimport { BloblStorage } from './../service/blobStorage';\r\nimport { bindable } from \"aurelia-framework\";\r\nimport { VisionResponse } from '../../Models/VisionResponse';\r\nimport { bindingMode } from 'aurelia-binding';\r\n\r\n@autoinject\r\nexport class FormUpload {\r\n    @bindable({ defaultBindingMode: bindingMode.twoWay }) pictureloading;\r\n    @bindable({ defaultBindingMode: bindingMode.twoWay }) pictures;\r\n    files;\r\n    constructor(private blobStorage: BloblStorage, private visionAPI: VisionApi) {\r\n\r\n    }\r\n\r\n    filedropped(event) {\r\n        event.preventDefault();\r\n        this.dragging = false;\r\n        this.files = event.dataTransfer.files;\r\n        this.Submit();\r\n    }\r\n    dragging;\r\n    dragOver(event) {\r\n        event.preventDefault();\r\n        this.dragging = true;\r\n    }\r\n    Submit() {\r\n        this.pictureloading = true;\r\n        this.blobStorage.SavePicture(this.files[0])\r\n            .then((picture: Picture) => {\r\n                this.visionAPI.processImage(picture.url).then((result: VisionResponse) => {\r\n                    picture.caption = result.caption;\r\n                    this.blobStorage.updateMetaDataForPicture(picture)\r\n                        .then((picture: Picture) => {\r\n                            this.pictures.push(picture);\r\n                            this.pictureloading = false;\r\n\r\n                        });\r\n                })\r\n            });\r\n    }\r\n\r\n\r\n}","import { bindingMode } from 'aurelia-binding';\r\nimport { BloblStorage } from './../service/blobStorage';\r\nimport { bindable, autoinject } from 'aurelia-framework';\r\n\r\n@autoinject\r\nexport class UploadedPicture {\r\n  @bindable pic;\r\n  @bindable({ defaultBindingMode: bindingMode.twoWay }) pictures;\r\n  constructor(private blobStorage: BloblStorage) {\r\n\r\n  }\r\n  DeleteImage(pic) {\r\n    this.blobStorage\r\n      .DeleteImage(pic)\r\n      .then(() => {\r\n        let index = this.pictures.indexOf(pic);\r\n        this.pictures.splice(index, 1);\r\n      });\r\n  }\r\n\r\n}\r\n\r\n","import { autoinject } from 'aurelia-dependency-injection';\r\nimport { Picture } from './../../Models/Picture';\r\nimport { HttpClient } from 'aurelia-http-client';\r\n\r\n@autoinject\r\nexport class BloblStorage {\r\n    pictureContainer = \"https://catstorageorix.blob.core.windows.net/temp\";\r\n    sharedKeyInfo = \"sv=2017-04-17&ss=bfqt&srt=sco&sp=rwdlacup&se=2017-11-24T20:50:05Z&st=2017-11-04T12:50:05Z&spr=https&sig=lTzCFbApWqiRXlCJ6RHSim9BP2GsYMucxtVGxssxfWg%3D\";\r\n\r\n    constructor(private httpClient: HttpClient) {\r\n\r\n    }\r\n    SavePicture(file) {\r\n\r\n        this.httpClient.configure(x => {\r\n            x.withHeader('x-ms-blob-type', 'BlockBlob');\r\n        });\r\n\r\n        return this.httpClient.put(`${this.pictureContainer}/${file.name}?${this.sharedKeyInfo}`, file).then((response) => {\r\n            let newPic = new Picture();\r\n            newPic.filename = file.name;\r\n            newPic.url = `${this.pictureContainer}/${file.name}`;\r\n            return newPic;\r\n        })\r\n    }\r\n\r\n    updateMetaDataForPicture(image: Picture) {\r\n        console.log(\"Meta data update\", image);\r\n        let client = new HttpClient().configure(x => {\r\n            x.withHeader('x-ms-blob-type', 'BlockBlob');\r\n        });\r\n\r\n        console.log(\"Vision response\", image)\r\n        return client.createRequest(`${this.pictureContainer}/${image.filename}?comp=metadata&${this.sharedKeyInfo}`)\r\n            .withHeader('x-ms-meta-caption', image.caption)\r\n            .asPut()\r\n            .send()\r\n            .then(() => image);\r\n    }\r\n\r\n\r\n\r\n    GetPictures() {\r\n\r\n        this.httpClient.configure(x => {\r\n            //        ajaxRequest.setRequestHeader('x-ms-blob-type', 'BlockBlob');\r\n            x.withHeader('Content-Type', 'application/json');\r\n        });\r\n\r\n\r\n        let url = `${this.pictureContainer}?restype=container&comp=list&${this.sharedKeyInfo}`\r\n        console.log(\"Container Emails\", url);\r\n        return this.httpClient.get(url).then((result) => {\r\n            let pictures = new Array<Picture>();\r\n            console.log(\"Getting Pics\", result);\r\n            var oParser = new DOMParser();\r\n            var oDOM = oParser.parseFromString(result.response, \"text/xml\");\r\n            console.log(oDOM);\r\n            var blobs = oDOM.getElementsByTagName(\"Blob\")\r\n            for (var index = 0; index < blobs.length; index++) {\r\n                console.log(\"Blob\", blobs[index]);\r\n                //let name = blobs[index].getElementsByTagName(\"Name\")[0].innerHTML;\r\n                let name = blobs[index].getElementsByTagName('Name')[0].textContent;\r\n                console.log(\"Name\", name);\r\n\r\n                let newResult = new Picture();\r\n                newResult.caption = name;\r\n                newResult.name = name;\r\n                newResult.url = `${this.pictureContainer}/${name}`;\r\n                newResult.filename = name;\r\n                pictures.push(newResult);\r\n\r\n            }\r\n            return pictures;\r\n\r\n\r\n        })\r\n    }\r\n\r\n    GetBlobCaption(filename) {\r\n        console.log(\"Blob url \", `${this.pictureContainer}/${filename}?${this.sharedKeyInfo}`);\r\n        return this.httpClient.get(`${this.pictureContainer}/${filename}?comp=metadata&${this.sharedKeyInfo}`).then((result) => {\r\n            console.log(\"Caption result\",result);\r\n            if (typeof (result.headers['headers']['x-ms-meta-caption']) == \"object\"){\r\n                return result.headers['headers']['x-ms-meta-caption'].value;\r\n            } else {\r\n                return \"\";\r\n            }\r\n\r\n\r\n        })\r\n    }\r\n\r\n\r\n    DeleteImage(picture: Picture) {\r\n        return this.httpClient\r\n            .delete(`${picture.url}?${this.sharedKeyInfo}`);\r\n\r\n\r\n    }\r\n}","import { Picture } from './../../Models/Picture';\r\nimport { VisionResponse } from './../../Models/VisionResponse';\r\nimport { HttpClient } from \"aurelia-http-client\";\r\nimport { autoinject } from 'aurelia-framework';\r\n\r\n@autoinject\r\nexport class VisionApi {\r\n\r\n    subscriptionKey = \"311f1c6de3f946e68713e6ca28c580d7\";\r\n    azureVisionAnalyzerAPI = \"https://westcentralus.api.cognitive.microsoft.com/vision/v1.0/analyze?visualFeatures=description\"\r\n    constructor(private httpClient: HttpClient) {\r\n\r\n        this.httpClient.configure(x => {\r\n            x.withHeader('Ocp-Apim-Subscription-Key', this.subscriptionKey);\r\n        });\r\n    }\r\n    processImage(imageURL) {\r\n        console.log(\"Processing image\", imageURL);\r\n\r\n        return this.httpClient.post(this.azureVisionAnalyzerAPI, {\r\n            url: imageURL\r\n        }).then((result) => {\r\n            console.log(\"I did get a result\", result);\r\n            return new VisionResponse(JSON.parse(result.response));\r\n        })\r\n    }\r\n\r\n\r\n\r\n}"],"sourceRoot":".."}